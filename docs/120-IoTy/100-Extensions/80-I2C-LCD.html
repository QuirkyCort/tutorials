<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

  <link href="../../css/pygment_default.css" rel="stylesheet">
  <link href="../../css/main.css" rel="stylesheet">
  <link href="../../css/print.css" rel="stylesheet" media="print">

  <title>IoTy Documentation</title>
</head>

<body>
    <div id="header">
        <div id="header-left">
            <a id="home" href="../../index.html"><i class="fa fa-home"></i></a>
            &nbsp;&nbsp;/&nbsp;&nbsp;
            IoTy Documentation
        </div>
        <div id="header-right">
            <a href="https://aposteriori.com.sg">
                <img src="../../images/logo.png">
            </a>
        </div>
    </div>

    <div id="body">
        <div id="sidebarOverlay"></div>
        <nav id="sidebar" role="navigation">
            <div id="sidebarHeader">Internet-of-Things made easy</div>
            <p>Intro to IoTy</p><ul><a href="../10-Introduction/10-Intro.html"><li >Introduction</li></a><a href="../10-Introduction/20-First-Program.html"><li >First Program</li></a><a href="../10-Introduction/30-Connection-Modes.html"><li >Connection Modes</li></a><a href="../10-Introduction/40-Monitor.html"><li >Monitor</li></a></ul><p>Basic Features</p><ul><a href="../20-Basics/10-GPIO-Pins.html"><li >GPIO Pins</li></a><a href="../20-Basics/20-Analog-Read-and-Write.html"><li >Analog Read and Write</li></a><a href="../20-Basics/30-Servo.html"><li >Servo</li></a><a href="../20-Basics/40-Ultrasonic-Distance.html"><li >Ultrasonic Distance (HC-SR04)</li></a><a href="../20-Basics/99-Python-Docs---pin.html"><li >Python Docs - pin</li></a></ul><p>Extensions</p><ul><a href="../100-Extensions/10-Gyro.html"><li >Gyro (MPU-6050)</li></a><a href="../100-Extensions/20-Servo-driver.html"><li >Servo Driver (PCA9685)</li></a><a href="../100-Extensions/30-SSD1306.html"><li >OLED Screen (SSD1306)</li></a><a href="../100-Extensions/40-urequests.html"><li >HTTP Requests (urequests)</li></a><a href="../100-Extensions/50-Neopixel.html"><li >Neopixel (WS2812 LEDs)</li></a><a href="../100-Extensions/60-EZ-ESP-NOW.html"><li >EZ ESP-NOW</li></a><a href="../100-Extensions/70-EZ-HTTPD.html"><li >EZ HTTP (Web Server)</li></a><a href="../100-Extensions/80-I2C-LCD.html"><li class="current">I2C LCD (HD44780 + PCF8574)</li></a></ul><p>Others Components</p><ul><a href="../200-Others/10-hbridge.html"><li >Intro to H-Bridge</li></a><a href="../200-Others/12-hbridgeControl2Pins.html"><li >Controlling a H-Bridge (2 pins)</li></a><a href="../200-Others/14-hbridgeControl3Pins.html"><li >Controlling a H-Bridge (3 pins)</li></a></ul>
        </nav>
        <div id="content">
            <h1>I2C LCD (HD44780 + PCF8574)</h1>
<p><img alt="" src="images/i2cLcd.webp" /></p>
<p>The HD44780 is a popular LCD screen, often paired with a PCF8574 IO expander for I2C control.
This extensions allows you to write text to such a screen.</p>
<div class="important">
Some HD44780 do not come with the PCF8574. This extension does not work on devices without the PCF8574! Compare your device with the above image to make sure you have the right type.
</div>

<h2>Pins</h2>
<p><img alt="" src="images/i2cLcd_pinout.webp" /></p>
<table>
<thead>
<tr>
<th>Pin</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>GND</td>
<td>Ground pin. This should be connected to the <strong>GND</strong> pin on the ESP32.</td>
</tr>
<tr>
<td>VCC</td>
<td>Power for the LCD. Connect to 5V. If using USB power, you can connect to the <strong>VIN</strong> pin on the ESP32.</td>
</tr>
<tr>
<td>SCL (Signal)</td>
<td>Serial Clock. This is used to communicate with the ESP32 using the I2C protocol.</td>
</tr>
<tr>
<td>SDA (Signal)</td>
<td>Serial Data. This is used to communicate with the ESP32 using the I2C protocol.</td>
</tr>
</tbody>
</table>
<h2>Wiring</h2>
<p>The example below uses power from <strong>VIN</strong>, this only works if your ESP32 is running on 5V (eg. USB power).</p>
<p><img alt="" src="images/i2cLcd_wiring.webp" /></p>
<h2>Code</h2>
<p>This code will display the time in milliseconds, updating once every second.</p>
<div class="important">
You will often need to adjust the contrast before any text is visible. You'll need a screwdriver to turn the potentiometer (blue square with screwdriver slot).
</div>

<h3>Blocks</h3>
<p><img alt="" src="images/i2cLcd_blocks.webp" /></p>
<p>The <code>draw text</code> block only accepts strings as input, so you must use a <code>convert to</code> block to convert the time (integer) into a string.
You can find the <code>convert to</code> block in the <code>Data</code> category.</p>
<h3>Python</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">machine</span>
<span class="kn">import</span> <span class="nn">i2c_lcd</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">i2c0</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">I2C</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="mi">100000</span><span class="p">)</span>
<span class="n">lcd</span> <span class="o">=</span> <span class="n">i2c_lcd</span><span class="o">.</span><span class="n">LCD</span><span class="p">(</span><span class="n">i2c0</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">lcd</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">lcd</span><span class="o">.</span><span class="n">putstr</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">ticks_ms</span><span class="p">()))</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>

<h3>Results</h3>
<p>You should see the time (...in milliseconds since reset) drawn on the screen and updating every 1 second.</p>
<h1><code>class LCD</code> - control HD44780 LCD screens with PCF8574 IO expander</h1>
<div class="custom_lib_docs">
<h2>Constructors</h2>
<h3>i2c_lcd.LCD(i2c, i2c_addr=39, num_lines=2, num_columns=16)</h3>
<p>Creates an LCD object.</p>
<p>The arguments are:</p>
<ul>
<li>
<p><code>i2c</code> An i2c object.</p>
</li>
<li>
<p><code>i2c_addr</code> The i2c address of the PCF8574. By default, this should be 39.</p>
</li>
<li>
<p><code>num_lines</code> An integer specifying the number of lines of text (...not pixels) on the screen.</p>
</li>
<li>
<p><code>num_columns</code> An integer specifying the number of character columns on the screen.</p>
</li>
</ul>
<p>Returns an <code>LCD</code> object.</p>
<h2>Methods</h2>
<h3>LCD.clear()</h3>
<p>Clears the screen and set the cursor to the top left corner (0, 0).</p>
<p>Returns <code>None</code>.</p>
<h3>LCD.show_cursor()</h3>
<p>Display the cursor on screen.</p>
<p>Returns <code>None</code>.</p>
<h3>LCD.hide_cursor()</h3>
<p>Hides the cursor on screen.</p>
<p>Returns <code>None</code>.</p>
<h3>LCD.blink_cursor_on()</h3>
<p>Makes the cursor blink.</p>
<p>Returns <code>None</code>.</p>
<h3>LCD.blink_cursor_off()</h3>
<p>Turns cursor blinking off.</p>
<p>Returns <code>None</code>.</p>
<h3>LCD.display_on()</h3>
<p>Turns on the display.</p>
<p>Returns <code>None</code>.</p>
<h3>LCD.display_off()</h3>
<p>Turns off the display</p>
<p>Returns <code>None</code>.</p>
<h3>LCD.backlight_on()</h3>
<p>Turns on the backlight.</p>
<p>Returns <code>None</code>.</p>
<h3>LCD.backlight_off()</h3>
<p>Turns off the backlight.</p>
<p>Returns <code>None</code>.</p>
<h3>LCD.move_to(cursor_x, cursor_y)</h3>
<p>Move the cursor to the specified position.</p>
<p>The arguments are:</p>
<ul>
<li>
<p><code>cursor_x</code> An integer specifying the x position to move to.</p>
</li>
<li>
<p><code>cursor_y</code> An integer specifying the y position to move to.</p>
</li>
</ul>
<p>Returns <code>None</code>.</p>
<h3>LCD.putchar(char)</h3>
<p>Draw a character at the current cursor position.
This will automatically wrap to the next line when it reaches the end of the line.
It will also wrap back to the top of the screen when it reaches the bottom.</p>
<p>The arguments are:</p>
<ul>
<li><code>char</code> A string containing a single character.</li>
</ul>
<p>Returns <code>None</code>.</p>
<h3>LCD.putstr(string)</h3>
<p>Draw a string starting at the current cursor position.
This will automatically wrap to the next line when it reaches the end of the line.
It will also wrap back to the top of the screen when it reaches the bottom.</p>
<p>The arguments are:</p>
<ul>
<li><code>string</code> A string containing the text to draw.</li>
</ul>
<p>Returns <code>None</code>.</p>
<h3>LDC.custom_char(location, charmap)</h3>
<p>Add a custom char.
The HD44780 can store up to 8 custom characters, each character is monochrome and 5x8 pixels.</p>
<p>This can be complicated to use.
Refer to the <strong>Custom Characters</strong> section in the <a href="https://github.com/dhylands/python_lcd/tree/master">docs here</a> to learn how.</p>
<p>The arguments are:</p>
<ul>
<li>
<p><code>location</code> A number (0 to 7) specifying the location to store the custom character.</p>
</li>
<li>
<p><code>charmap</code> A bytes object providing the character map of the custom character.</p>
</li>
</ul>
<p>Returns <code>None</code>.</p>
</div>
        </div>
        <button type="button" id="hamburger">
            <div id="hamburgerTop"></div>
            <div id="hamburgerBottom"></div>
        </button>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            document.getElementById('hamburger').addEventListener('click', function() {
                document.getElementById('body').classList.toggle('close');
            });

            let currentEle = document.querySelector('#sidebar li.current');
            currentEle.scrollIntoView({
                behavior: 'smooth',
                block: 'center'
            });
        });
    </script>
</body>
</html>