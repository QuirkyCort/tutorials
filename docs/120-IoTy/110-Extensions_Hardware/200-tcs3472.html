<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

  <link href="../../css/pygment_default.css" rel="stylesheet">
  <link href="../../css/main.css" rel="stylesheet">
  <link href="../../css/print.css" rel="stylesheet" media="print">

  <title>IoTy Documentation</title>
</head>

<body>
    <div id="header">
        <div id="header-left">
            <a id="home" href="../../index.html"><i class="fa fa-home"></i></a>
            &nbsp;&nbsp;/&nbsp;&nbsp;
            IoTy Documentation
        </div>
        <div id="header-right">
            <a href="https://aposteriori.com.sg">
                <img src="../../images/logo.png">
            </a>
        </div>
    </div>

    <div id="body">
        <div id="sidebarOverlay"></div>
        <nav id="sidebar" role="navigation">
            <div id="sidebarHeader">Internet-of-Things made easy</div>
            <p class="sectionTitle close" data-section="IntrotoIoTy"><i class="plus fa fa-plus-square-o" aria-hidden="true"></i><i class="minus fa fa-minus-square-o" aria-hidden="true"></i> Intro to IoTy</p><ul class="IntrotoIoTy hide"><a href="../10-Introduction/10-Intro.html"><li >Introduction</li></a><a href="../10-Introduction/20-First-Program.html"><li >First Program</li></a><a href="../10-Introduction/30-Connection-Modes.html"><li >Connection Modes</li></a><a href="../10-Introduction/40-Monitor.html"><li >Monitor</li></a></ul><p class="sectionTitle close" data-section="BasicFeaturesGPIO"><i class="plus fa fa-plus-square-o" aria-hidden="true"></i><i class="minus fa fa-minus-square-o" aria-hidden="true"></i> Basic Features (GPIO)</p><ul class="BasicFeaturesGPIO hide"><a href="../20-Basics-GPIO/10-GPIO-Pins.html"><li >GPIO Pins</li></a><a href="../20-Basics-GPIO/20-Analog-Read-and-Write.html"><li >Analog Read and Write</li></a><a href="../20-Basics-GPIO/30-Servo.html"><li >Servo</li></a><a href="../20-Basics-GPIO/40-Ultrasonic-Distance.html"><li >Ultrasonic Distance (HC-SR04)</li></a><a href="../20-Basics-GPIO/99-Python-Docs---pin.html"><li >Python Docs - pin</li></a></ul><p class="sectionTitle close" data-section="ExtensionsSoftware"><i class="plus fa fa-plus-square-o" aria-hidden="true"></i><i class="minus fa fa-minus-square-o" aria-hidden="true"></i> Extensions (Software)</p><ul class="ExtensionsSoftware hide"><a href="../100-Extensions_Software/10-urequests.html"><li >HTTP Requests (urequests)</li></a><a href="../100-Extensions_Software/20-EZ-ESP-NOW.html"><li >EZ ESP-NOW</li></a><a href="../100-Extensions_Software/30-EZ-HTTPD.html"><li >EZ HTTP (Web Server)</li></a><a href="../100-Extensions_Software/40-non-block.html"><li >Non-Blocking Read</li></a><a href="../100-Extensions_Software/50-EZ-Timer.html"><li >EZ Timer</li></a><a href="../100-Extensions_Software/60-tween.html"><li >Tween</li></a><a href="../100-Extensions_Software/70-BLE-HID.html"><li >Bluetooth Low Energy Human Interface Device</li></a></ul><p class="sectionTitle close" data-section="ExtensionsHardware"><i class="plus fa fa-plus-square-o" aria-hidden="true"></i><i class="minus fa fa-minus-square-o" aria-hidden="true"></i> Extensions (Hardware)</p><ul class="ExtensionsHardware hide"><a href="../110-Extensions_Hardware/10-Gyro.html"><li >Gyro (MPU-6050)</li></a><a href="../110-Extensions_Hardware/20-Servo-driver.html"><li >Servo Driver (PCA9685)</li></a><a href="../110-Extensions_Hardware/30-SSD1306.html"><li >OLED Screen (SSD1306 / SH1106)</li></a><a href="../110-Extensions_Hardware/40-Neopixel.html"><li >Neopixel (WS2812 LEDs)</li></a><a href="../110-Extensions_Hardware/50-I2C-LCD.html"><li >I2C LCD (HD44780 + PCF8574)</li></a><a href="../110-Extensions_Hardware/60-DHT11.html"><li >Temperature and Humidity (DHT11, DHT22, AM2302)</li></a><a href="../110-Extensions_Hardware/70-EZ-DS18X20.html"><li >Temperature Sensor (DS18S20, DS18B20)</li></a><a href="../110-Extensions_Hardware/80-GPS.html"><li >GPS (NMEA over serial)</li></a><a href="../110-Extensions_Hardware/90-hx711.html"><li >Analog-to-Digital (HX711)</li></a><a href="../110-Extensions_Hardware/100-hx710.html"><li >Analog-to-Digital (HX710)</li></a><a href="../110-Extensions_Hardware/110-MFRC522.html"><li >RFID Reader (MFRC522)</li></a><a href="../110-Extensions_Hardware/120-Magnetic-Sensor.html"><li >Magnetic Sensor (QMC5883L, HMC5883L)</li></a><a href="../110-Extensions_Hardware/130-Barometric-Pressure.html"><li >Barometric Pressure (BMP280, BME280)</li></a><a href="../110-Extensions_Hardware/140-Heart-Rate.html"><li >Heart Rate Sensor (MAX30102)</li></a><a href="../110-Extensions_Hardware/150-ToF.html"><li >Laser Ranging (VL53L0X, VL52L1X)</li></a><a href="../110-Extensions_Hardware/160-rtc-ds3231.html"><li >Real-Time Clock (DS3231)</li></a><a href="../110-Extensions_Hardware/170-apds9960.html"><li >Light, Proximity, Gesture (APDS9960)</li></a><a href="../110-Extensions_Hardware/180-gy33_i2c.html"><li >Color Sensor (GY-33, I2C)</li></a><a href="../110-Extensions_Hardware/190-gy33_uart.html"><li >Color Sensor (GY-33, UART)</li></a><a href="../110-Extensions_Hardware/200-tcs3472.html"><li class="current">Color Sensor (TCS3472)</li></a><a href="../110-Extensions_Hardware/210-max6675.html"><li >Thermocouple Board (MAX6675)</li></a><a href="../110-Extensions_Hardware/220-encoder.html"><li >Incremental Encoder</li></a><a href="../110-Extensions_Hardware/230-husky-lens.html"><li >Husky Lens</li></a><a href="../110-Extensions_Hardware/250-music.html"><li >Music</li></a><a href="../110-Extensions_Hardware/260-Scaled-Text.html"><li >Scaled Text</li></a><a href="../110-Extensions_Hardware/270-PNG-decoder.html"><li >PNG Decoder</li></a><a href="../110-Extensions_Hardware/280-BMP-Image.html"><li >BMP Image</li></a><a href="../110-Extensions_Hardware/290-serial-mp3.html"><li >Serial MP3 Player (YX5300, YX6300)</li></a><a href="../110-Extensions_Hardware/300-ld2410.html"><li >Human Presence Radar (LD2410)</li></a></ul><p class="sectionTitle close" data-section="OthersComponents"><i class="plus fa fa-plus-square-o" aria-hidden="true"></i><i class="minus fa fa-minus-square-o" aria-hidden="true"></i> Others Components</p><ul class="OthersComponents hide"><a href="../200-Others/10-hbridge.html"><li >Intro to H-Bridge</li></a><a href="../200-Others/12-hbridgeControl2Pins.html"><li >Controlling a H-Bridge (2 pins)</li></a><a href="../200-Others/14-hbridgeControl3Pins.html"><li >Controlling a H-Bridge (3 pins)</li></a></ul>
        </nav>
        <div id="content">
            <h1>Color Sensor (TCS3472)</h1>
<p><img alt="" src="images/tcs3472.webp" /></p>
<p>The TCS3472 is a color sensor, useful in robotics for line following or color detection.</p>
<h2>Pins</h2>
<p><img alt="" src="images/tcs3472_pinout.webp" /></p>
<table>
<thead>
<tr>
<th>Pin</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>VIN</td>
<td>Power for the sensor. Connect to <strong>VIN</strong> (5V) if using USB power. You can also leave this unconnected and supply power through the <strong>3V3</strong> pin.</td>
</tr>
<tr>
<td>GND</td>
<td>Ground pin. One of these should be connected to the <strong>GND</strong> pin on the ESP32.</td>
</tr>
<tr>
<td>3V3</td>
<td>Power for the sensor. Connect to <strong>3V3</strong> on the ESP32.</td>
</tr>
<tr>
<td>SCL</td>
<td>Serial Clock. This is used to communicate with the ESP32 using the I2C protocol (default pin 18).</td>
</tr>
<tr>
<td>SDA</td>
<td>Serial Data. This is used to communicate with the ESP32 using the I2C protocol (default pin 19).</td>
</tr>
<tr>
<td>INT</td>
<td>Not using this. Leave it unconnected.</td>
</tr>
<tr>
<td>LED</td>
<td>You can turn off the LED by connecting this to <strong>GND</strong>. Else, leave it unconnected.</td>
</tr>
</tbody>
</table>
<h2>Wiring</h2>
<p><img alt="" src="images/tcs3472_wiring.webp" /></p>
<h2>Code</h2>
<p>This code will print the raw readings.
You can also print the calibrated readings using the "read value" block, but unless you perform a calibration first, the calibrated readings are likely no more useful than the raw readings.</p>
<h3>Blocks</h3>
<p><img alt="" src="images/tcs3472_blocks.webp" /></p>
<h3>Python</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">machine</span>
<span class="kn">import</span> <span class="nn">tcs3472</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">i2c0</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">I2C</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="mi">100000</span><span class="p">)</span>
<span class="n">tcs3472_device</span> <span class="o">=</span> <span class="n">tcs3472</span><span class="o">.</span><span class="n">TCS3472</span><span class="p">(</span><span class="n">i2c0</span><span class="p">,</span> <span class="n">addr</span><span class="o">=</span><span class="mi">41</span><span class="p">)</span>
<span class="n">tcs3472_device</span><span class="o">.</span><span class="n">set_gain</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">tcs3472_device</span><span class="o">.</span><span class="n">set_integration_time</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">tcs3472_device</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>

<h3>Results</h3>
<p>You should see the the sensor readings printed in the monitor; each reading is a list of 4 number representing the detected clear (...any color), red, green, and blue.</p>
<p>If you bring a colored object (eg. red) near to the sensor, you should see the green and blue value fall, while the red value remain high.</p>
<h1><code>class TCS3472</code> - control TCS3472 color sensor</h1>
<div class="custom_lib_docs">
<h2>Constructors</h2>
<h3>tcs3472.TCS3472(i2c, addr=41)</h3>
<p>Creates a TCS3472 object.</p>
<p>The arguments are:</p>
<ul>
<li>
<p><code>i2c</code> An i2c object.</p>
</li>
<li>
<p><code>addr</code> The i2c address of the TCS3472. By default, this should be 41.</p>
</li>
</ul>
<p>Returns a <code>TCS3472</code> object.</p>
<h2>Methods</h2>
<h3>TCS3472.set_gain(gain)</h3>
<p>Sets the gain.</p>
<p>The arguments are:</p>
<ul>
<li><code>gain</code> An integer (0 to 3) representing a gain of 1x, 4x, 16x, and 60x.</li>
</ul>
<p>Returns <code>None</code>.</p>
<h3>TCS3472.set_integration_time(ms)</h3>
<p>Sets the integration time in milliseconds.
A higher integration time will provide a higher resolution, but at the expense of a lower update rate.</p>
<p>The arguments are:</p>
<ul>
<li><code>ms</code> A float representing the integration time in ms. Must be between 2.4 to 614.4.</li>
</ul>
<p>Returns <code>None</code>.</p>
<h3>TCS3472.read()</h3>
<p>Gets the clear, red, green, and blue values.</p>
<p>Returns a list containing 4 integers (0 to 65535), representing the clear (any color), red, green, and blue  values.</p>
<h3>TCS3472.read_calibrated()</h3>
<p>Gets the calibrated red, green, blue, and clear values.</p>
<p>If calibration is done, black should return 0 for all values, and white 255 for all values.
Note that due to changes in environment and inaccuracies in calibration, it is possible for the returned values to be less than 0 or greater than 255.</p>
<p>Returns a list containing 4 integers (approximately 0 to 255), representing the clear (any color), red, green, and blue values.</p>
<h3>TCS3472.calibrate_white()</h3>
<p>Sets the white calibration.</p>
<p>The sensor should be on white before you run this.</p>
<p>Returns <code>None</code>.</p>
<h3>TCS3472.calibrate_black()</h3>
<p>Sets the black calibration.</p>
<p>The sensor should be on black before you run this.</p>
<p>Returns <code>None</code>.</p>
</div>
        </div>
        <button type="button" id="hamburger">
            <div id="hamburgerTop"></div>
            <div id="hamburgerBottom"></div>
        </button>
    </div>

    <script>
        function initHamburger() {
            document.getElementById('hamburger').addEventListener('click', function() {
                document.getElementById('body').classList.toggle('close');
            });
        }

        function initSectionMenu() {
            function clickHandler(evt) {
                let sectionTitle = evt.currentTarget;
                let classname = sectionTitle.attributes['data-section'].value;
                let sectionChild = document.querySelector('ul.' + classname);
                if (sectionChild.classList.contains('hide')) {
                    sectionChild.classList.remove('hide');
                    sectionTitle.classList.remove('close');
                } else {
                    sectionChild.classList.add('hide');
                    sectionTitle.classList.add('close');
                }
            }

            let sectionTitles = document.getElementsByClassName('sectionTitle');
            for (let sectionTitle of sectionTitles) {
                sectionTitle.addEventListener('click', clickHandler);
            }
        }

        function scrollSectionIntoView() {
            let currentEle = document.querySelector('#sidebar li.current');
            currentEle.scrollIntoView({
                behavior: 'smooth',
                block: 'center'
            });

            let hiddenParent = currentEle.closest('.hide');
            if (hiddenParent) {
                hiddenParent.classList.remove('hide');
                hiddenParent.previousElementSibling.classList.remove('close');
            }
        }

        document.addEventListener('DOMContentLoaded', function () {
            initHamburger();
            initSectionMenu();
            scrollSectionIntoView();
        });
    </script>
</body>
</html>