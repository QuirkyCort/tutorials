<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

  <link href="../../css/pygment_default.css" rel="stylesheet">
  <link href="../../css/main.css" rel="stylesheet">
  <link href="../../css/print.css" rel="stylesheet" media="print">

  <title>IoTy Documentation</title>
</head>

<body>
    <div id="header">
        <div id="header-left">
            <a id="home" href="../../index.html"><i class="fa fa-home"></i></a>
            &nbsp;&nbsp;/&nbsp;&nbsp;
            IoTy Documentation
        </div>
        <div id="header-right">
            <a href="https://aposteriori.com.sg">
                <img src="../../images/logo.png">
            </a>
        </div>
    </div>

    <div id="body">
        <div id="sidebarOverlay"></div>
        <nav id="sidebar" role="navigation">
            <div id="sidebarHeader">Internet-of-Things made easy</div>
            <p class="sectionTitle close" data-section="IntrotoIoTy"><i class="plus fa fa-plus-square-o" aria-hidden="true"></i><i class="minus fa fa-minus-square-o" aria-hidden="true"></i> Intro to IoTy</p><ul class="IntrotoIoTy hide"><a href="../10-Introduction/10-Intro.html"><li >Introduction</li></a><a href="../10-Introduction/20-First-Program.html"><li >First Program</li></a><a href="../10-Introduction/30-Connection-Modes.html"><li >Connection Modes</li></a><a href="../10-Introduction/40-Monitor.html"><li >Monitor</li></a></ul><p class="sectionTitle close" data-section="BasicFeaturesGPIO"><i class="plus fa fa-plus-square-o" aria-hidden="true"></i><i class="minus fa fa-minus-square-o" aria-hidden="true"></i> Basic Features (GPIO)</p><ul class="BasicFeaturesGPIO hide"><a href="../20-Basics-GPIO/10-GPIO-Pins.html"><li >GPIO Pins</li></a><a href="../20-Basics-GPIO/20-Analog-Read-and-Write.html"><li >Analog Read and Write</li></a><a href="../20-Basics-GPIO/30-Servo.html"><li >Servo</li></a><a href="../20-Basics-GPIO/40-Ultrasonic-Distance.html"><li >Ultrasonic Distance (HC-SR04)</li></a><a href="../20-Basics-GPIO/99-Python-Docs---pin.html"><li >Python Docs - pin</li></a></ul><p class="sectionTitle close" data-section="ExtensionsSoftware"><i class="plus fa fa-plus-square-o" aria-hidden="true"></i><i class="minus fa fa-minus-square-o" aria-hidden="true"></i> Extensions (Software)</p><ul class="ExtensionsSoftware hide"><a href="../100-Extensions_Software/10-urequests.html"><li >HTTP Requests (urequests)</li></a><a href="../100-Extensions_Software/20-EZ-ESP-NOW.html"><li >EZ ESP-NOW</li></a><a href="../100-Extensions_Software/30-EZ-HTTPD.html"><li >EZ HTTP (Web Server)</li></a><a href="../100-Extensions_Software/40-non-block.html"><li >Non-Blocking Read</li></a><a href="../100-Extensions_Software/50-EZ-Timer.html"><li >EZ Timer</li></a><a href="../100-Extensions_Software/60-tween.html"><li >Tween</li></a><a href="../100-Extensions_Software/70-BLE-HID.html"><li >Bluetooth Low Energy Human Interface Device</li></a></ul><p class="sectionTitle close" data-section="ExtensionsHardware"><i class="plus fa fa-plus-square-o" aria-hidden="true"></i><i class="minus fa fa-minus-square-o" aria-hidden="true"></i> Extensions (Hardware)</p><ul class="ExtensionsHardware hide"><a href="../110-Extensions_Hardware/10-Gyro.html"><li >Gyro (MPU-6050)</li></a><a href="../110-Extensions_Hardware/20-Servo-driver.html"><li >Servo Driver (PCA9685)</li></a><a href="../110-Extensions_Hardware/30-SSD1306.html"><li >OLED Screen (SSD1306 / SH1106)</li></a><a href="../110-Extensions_Hardware/40-Neopixel.html"><li >Neopixel (WS2812 LEDs)</li></a><a href="../110-Extensions_Hardware/50-I2C-LCD.html"><li >I2C LCD (HD44780 + PCF8574)</li></a><a href="../110-Extensions_Hardware/60-DHT11.html"><li >Temperature and Humidity (DHT11, DHT22, AM2302)</li></a><a href="../110-Extensions_Hardware/70-EZ-DS18X20.html"><li >Temperature Sensor (DS18S20, DS18B20)</li></a><a href="../110-Extensions_Hardware/80-GPS.html"><li >GPS (NMEA over serial)</li></a><a href="../110-Extensions_Hardware/90-hx711.html"><li >Analog-to-Digital (HX711)</li></a><a href="../110-Extensions_Hardware/100-hx710.html"><li >Analog-to-Digital (HX710)</li></a><a href="../110-Extensions_Hardware/110-MFRC522.html"><li >RFID Reader (MFRC522)</li></a><a href="../110-Extensions_Hardware/120-Magnetic-Sensor.html"><li >Magnetic Sensor (QMC5883L, HMC5883L)</li></a><a href="../110-Extensions_Hardware/130-Barometric-Pressure.html"><li >Barometric Pressure (BMP280, BME280)</li></a><a href="../110-Extensions_Hardware/140-Heart-Rate.html"><li >Heart Rate Sensor (MAX30102)</li></a><a href="../110-Extensions_Hardware/150-ToF.html"><li >Laser Ranging (VL53L0X, VL52L1X)</li></a><a href="../110-Extensions_Hardware/160-rtc-ds3231.html"><li >Real-Time Clock (DS3231)</li></a><a href="../110-Extensions_Hardware/170-apds9960.html"><li >Light, Proximity, Gesture (APDS9960)</li></a><a href="../110-Extensions_Hardware/180-gy33_i2c.html"><li >Color Sensor (GY-33, I2C)</li></a><a href="../110-Extensions_Hardware/190-gy33_uart.html"><li >Color Sensor (GY-33, UART)</li></a><a href="../110-Extensions_Hardware/200-tcs3472.html"><li >Color Sensor (TCS3472)</li></a><a href="../110-Extensions_Hardware/210-max6675.html"><li >Thermocouple Board (MAX6675)</li></a><a href="../110-Extensions_Hardware/220-encoder.html"><li >Incremental Encoder</li></a><a href="../110-Extensions_Hardware/230-husky-lens.html"><li class="current">Husky Lens</li></a><a href="../110-Extensions_Hardware/250-music.html"><li >Music</li></a><a href="../110-Extensions_Hardware/260-Scaled-Text.html"><li >Scaled Text</li></a><a href="../110-Extensions_Hardware/270-PNG-decoder.html"><li >PNG Decoder</li></a><a href="../110-Extensions_Hardware/280-BMP-Image.html"><li >BMP Image</li></a></ul><p class="sectionTitle close" data-section="OthersComponents"><i class="plus fa fa-plus-square-o" aria-hidden="true"></i><i class="minus fa fa-minus-square-o" aria-hidden="true"></i> Others Components</p><ul class="OthersComponents hide"><a href="../200-Others/10-hbridge.html"><li >Intro to H-Bridge</li></a><a href="../200-Others/12-hbridgeControl2Pins.html"><li >Controlling a H-Bridge (2 pins)</li></a><a href="../200-Others/14-hbridgeControl3Pins.html"><li >Controlling a H-Bridge (3 pins)</li></a></ul>
        </nav>
        <div id="content">
            <h1>Husky Lens</h1>
<p><img alt="" src="images/huskylens.webp" /></p>
<p>The Husky Lens is a camera with some built-in machine vision capabilities (eg. face recognition, object tracking, object recognition, line tracking, colour recognition and tag (QR code) recognition).
It is capable of communicating with the IoTy device via I2C or UART.</p>
<h2>Pins</h2>
<p><img alt="" src="images/huskylens_pinout.webp" /></p>
<h3>UART Mode</h3>
<table>
<thead>
<tr>
<th>Pin</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>T</td>
<td>Data transmit. This should be connected to the UART <strong>RX</strong> pin on the ESP32 (default is Pin 5).</td>
</tr>
<tr>
<td>R</td>
<td>Data receive. This should be connected to the UART <strong>TX</strong> pin on the ESP32 (default is Pin 4).</td>
</tr>
<tr>
<td>-</td>
<td>Ground pin. Connect to the <strong>GND</strong> pin on the ESP32.</td>
</tr>
<tr>
<td>+</td>
<td>Power for the sensor. Connect to <strong>3V3</strong>. If your device is on USB power, you can also use <strong>VIN</strong>.</td>
</tr>
</tbody>
</table>
<h3>I2C Mode</h3>
<table>
<thead>
<tr>
<th>Pin</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>T</td>
<td>Serial Data. This is used to communicate with the ESP32 using the I2C protocol (default pin 19).</td>
</tr>
<tr>
<td>R</td>
<td>Serial Clock. This is used to communicate with the ESP32 using the I2C protocol (default pin 18).</td>
</tr>
<tr>
<td>-</td>
<td>Ground pin. Connect to the <strong>GND</strong> pin on the ESP32.</td>
</tr>
<tr>
<td>+</td>
<td>Power for the sensor. Connect to <strong>3V3</strong>. If your device is on USB power, you can also use <strong>VIN</strong>.</td>
</tr>
</tbody>
</table>
<div class="important">
The Husky Lens consumes 320mA at 3.3V. It is likely that your ESP32 won't be able to supply this, so it is preferable to use VIN.
</div>

<h2>Wiring</h2>
<h3>UART Mode</h3>
<p><img alt="" src="images/huskylens_wiring_uart.webp" /></p>
<h3>I2C Mode</h3>
<p><img alt="" src="images/huskylens_wiring_i2c.webp" /></p>
<h2>Code</h2>
<p>This code will print the full result (list of dictionaries).</p>
<h3>Blocks</h3>
<p><strong>UART Mode</strong></p>
<p><img alt="" src="images/huskylens_blocks_uart.webp" /></p>
<p><strong>I2C Mode</strong></p>
<p><img alt="" src="images/huskylens_blocks_uart.webp" /></p>
<h3>Python</h3>
<p><strong>UART Mode</strong></p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">machine</span>
<span class="kn">import</span> <span class="nn">huskylib</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">uart1</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">UART</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">baudrate</span><span class="o">=</span><span class="mi">9600</span><span class="p">,</span> <span class="n">tx</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">rx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">huskylens</span> <span class="o">=</span> <span class="n">huskylib</span><span class="o">.</span><span class="n">HuskyLensUART</span><span class="p">(</span><span class="n">uart1</span><span class="p">)</span>
<span class="n">huskylens</span><span class="o">.</span><span class="n">algorithm</span><span class="p">(</span><span class="n">huskylib</span><span class="o">.</span><span class="n">OBJECT_RECOGNITION</span><span class="p">)</span>
<span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">huskylens</span><span class="o">.</span><span class="n">requestAll</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">huskylens</span><span class="o">.</span><span class="n">results</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>

<p><strong>I2C Mode</strong></p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">machine</span>
<span class="kn">import</span> <span class="nn">huskylib</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">i2c0</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">I2C</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="mi">100000</span><span class="p">)</span>
<span class="n">huskylens</span> <span class="o">=</span> <span class="n">huskylib</span><span class="o">.</span><span class="n">HuskyLensI2C</span><span class="p">(</span><span class="n">i2c0</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">huskylens</span><span class="o">.</span><span class="n">algorithm</span><span class="p">(</span><span class="n">huskylib</span><span class="o">.</span><span class="n">OBJECT_RECOGNITION</span><span class="p">)</span>
<span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">huskylens</span><span class="o">.</span><span class="n">requestAll</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">huskylens</span><span class="o">.</span><span class="n">results</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>

<h3>Results</h3>
<p>You should see the detection result printed in the monitor.
Each set of results is a list of dictionary, and each dictionary entry consists of...</p>
<p><strong>Block Type</strong></p>
<ul>
<li>x =&gt; (Integer) x coordinate of the center of the square</li>
<li>y =&gt; (Integer) y coordinate of the center of the square</li>
<li>width  =&gt;  (Integer) width of the square</li>
<li>height =&gt;  (Integer) height of the square</li>
<li>ID =&gt; (Integer) Objects ID (if not learned, ID is 0)</li>
<li>learned =&gt; (Boolean) True  if the object is learned</li>
<li>type =&gt; "BLOCK"</li>
</ul>
<p><strong>Arrow Type</strong> (Line Tracking mode only)</p>
<ul>
<li>xTail =&gt; (Integer) x coordinate of the tail of the arrow</li>
<li>yTail =&gt; (Integer) y coordinate of the tail of the arrow</li>
<li>xHead =&gt; (Integer) x coordinate of the head of the arrow</li>
<li>yHead =&gt; (Integer) y coordinate of the head of the arrow</li>
<li>ID =&gt; (Integer) Objects ID (if not learned, ID is 0)</li>
<li>learned =&gt; (Boolean) True  if the object is learned</li>
<li>type =&gt; "ARROW"</li>
</ul>
<h1>Python Documentation</h1>
<p>Refer to https://github.com/HuskyLens/HUSKYLENSPython for the Python documentation.</p>
        </div>
        <button type="button" id="hamburger">
            <div id="hamburgerTop"></div>
            <div id="hamburgerBottom"></div>
        </button>
    </div>

    <script>
        function initHamburger() {
            document.getElementById('hamburger').addEventListener('click', function() {
                document.getElementById('body').classList.toggle('close');
            });
        }

        function initSectionMenu() {
            function clickHandler(evt) {
                let sectionTitle = evt.currentTarget;
                let classname = sectionTitle.attributes['data-section'].value;
                let sectionChild = document.querySelector('ul.' + classname);
                if (sectionChild.classList.contains('hide')) {
                    sectionChild.classList.remove('hide');
                    sectionTitle.classList.remove('close');
                } else {
                    sectionChild.classList.add('hide');
                    sectionTitle.classList.add('close');
                }
            }

            let sectionTitles = document.getElementsByClassName('sectionTitle');
            for (let sectionTitle of sectionTitles) {
                sectionTitle.addEventListener('click', clickHandler);
            }
        }

        function scrollSectionIntoView() {
            let currentEle = document.querySelector('#sidebar li.current');
            currentEle.scrollIntoView({
                behavior: 'smooth',
                block: 'center'
            });

            let hiddenParent = currentEle.closest('.hide');
            if (hiddenParent) {
                hiddenParent.classList.remove('hide');
            }

            let closedParent = currentEle.closest('.close');
            if (closedParent) {
                closedParent.classList.remove('close');
            }
        }

        document.addEventListener('DOMContentLoaded', function () {
            initHamburger();
            initSectionMenu();
            scrollSectionIntoView();
        });
    </script>
</body>
</html>